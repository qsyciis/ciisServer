<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qzi.cms.server.mapper.UseResidentMapper">
   <!-- 条件分页查询 -->
	<select id="findAll" resultType="UseResidentVo" parameterType="String">
		SELECT ur.*,uc.communityName from use_resident ur,use_community uc,use_community_user ucu 
		<where>
			ur.communityId = uc.id and uc.id = ucu.communityId and ucu.userId=#{uid}
			<if test="criteria != null and criteria !=''">
				<bind name="pun" value="'%'+_parameter.criteria+'%'"/>
				and (ur.name like #{pun} or ur.mobile like #{pun})
			</if>
		</where>
		order by createTime desc
	</select>
   
	<select id="findCount" resultType="long" parameterType="String">
		SELECT count(1) from use_resident ur,use_community uc,use_community_user ucu 
		<where>
			ur.communityId = uc.id and uc.id = ucu.communityId and ucu.userId=#{uid}
			<if test="criteria != null and criteria !=''">
				<bind name="pun" value="'%'+_parameter.criteria+'%'"/>
				and (ur.name like #{pun} or ur.mobile like #{pun})
			</if>
		</where>
	</select>
</mapper>